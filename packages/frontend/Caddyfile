{
	email {$ACME_EMAIL}
}

agentbox.cascade.fyi {
	tls {
		dns cloudflare {env.CF_API_TOKEN}
		resolvers 1.1.1.1
	}

	handle /api/* {
		reverse_proxy backend:8080
	}
	handle /health {
		reverse_proxy backend:8080
	}
	handle {
		root * /srv
		try_files {path} /index.html
		file_server
	}
}

*.agentbox.cascade.fyi {
	tls {
		dns cloudflare {env.CF_API_TOKEN}
		resolvers 1.1.1.1
	}

	handle {
		abort
	}
}
